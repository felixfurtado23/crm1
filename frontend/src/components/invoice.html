 <!DOCTYPE html>
    <html>
    <head>

    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', sans-serif;
  line-height: 1.6;
  color: #1f221f;
  padding: 30px;
}

.invoice-container {
  max-width: 800px;
  margin: 0 auto;
  border: 2px solid #375b6d;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(20, 30, 20, 0.08);
    background: #ecebe6;

}

.header {
  background: linear-gradient(135deg, #375b6d 0%, #4a636e 100%);
  padding: 30px 40px;
  color: white;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.company-info h1 {
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 5px;
}

.company-info .tagline {
  font-size: 14px;
  opacity: 0.9;
  font-weight: 300;
}

.logo img {
  height: 60px;
  filter: brightness(0) invert(1);
}

.invoice-title {
  background: #4a636e;
  padding: 15px 40px;
  text-align: center;
  color: white;
  font-size: 20px;
  font-weight: 600;
  letter-spacing: 1px;
}

.details-section {
  padding: 30px 40px;
  background-color: #ecebe6;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 40px;
  border-bottom: 1px solid #e0e0e0;
}

.from-to h3, .invoice-meta h3 {
  font-size: 16px;
  font-weight: 600;
  color: #375b6d;
  margin-bottom: 15px;
  padding-bottom: 8px;
  border-bottom: 2px solid #375b6d;
}

.address-block {
  font-size: 13px;
  line-height: 1.8;
}

.address-block strong {
  display: block;
  margin-bottom: 5px;
  color: #1f221f;
}

.meta-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 20px;
  margin-top: 15px;
}

.meta-item {
  display: flex;
  flex-direction: column;
}

.meta-label {
  font-size: 11px;
  color: #8b8f8c;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.meta-value {
  font-size: 14px;
  font-weight: 600;
  color: #1f221f;
}

.items-section {
  padding: 0 40px;
}

.items-table {
  width: 100%;
  border-collapse: collapse;
  margin: 20px 0;
  table-layout: fixed;
}

.items-table th {
  padding: 12px 10px;
  text-align: left;
  font-size: 12px;
  font-weight: 600;
  color: #375b6d;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 2px solid #375b6d;
}

.items-table td {
  padding: 12px 10px;
  border-bottom: 1px solid #e9ecef;
  font-size: 13px;
  vertical-align: top;
}

.items-table tr:last-child td {
  border-bottom: none;
}

.totals-section {
  padding: 20px 40px;
  border-top: 2px solid #e9ecef;
}

.total-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  font-size: 14px;
}

.total-row.final {
  border-top: 2px solid #dee2e6;
  margin-top: 10px;
  padding-top: 15px;
  font-size: 18px;
  font-weight: 700;
  color: #375b6d;
}

.payment-section {
  padding: 30px 40px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 40px;
  border-top: 1px solid #e0e0e0;
}

.bank-details h4, .signature-section h4 {
  font-size: 14px;
  font-weight: 600;
  color: #375b6d;
  margin-bottom: 15px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.bank-info {
  font-size: 12px;
  line-height: 2;
}

.signature-area {
  text-align: center;
  margin-top: 20px;
}

.signature-img {
  height: 50px;
  margin-bottom: 10px;
  opacity: 0.8;
}

.stamp-img {
  height: 80px;
  margin-top: 10px;
  opacity: 0.9;
}

.signature-line {
  border-top: 1px solid #1f221f;
  width: 200px;
  margin: 0 auto 10px;
}

.footer {
  background: #375b6d;
  padding: 20px 40px;
  text-align: center;
  color: white;
  font-size: 11px;
}

.footer p {
  margin: 4px 0;
  opacity: 0.8;
}

.amount {
  text-align: right;
  font-weight: 600;
}

.text-right {
  text-align: right;
}

.text-center {
  text-align: center;
}
      </style>
    </head>
    <body>
      <div class="invoice-container">
        <!-- Header -->
        <div class="header">
          <div class="company-info">
            <h1>MERZAAI</h1>
            <div class="tagline">Intelligent Business Solutions</div>
          </div>
          <div class="logo">
            <img src="https://i0.wp.com/merzaai.com/wp-content/uploads/2025/07/Merzaai-logo-1-1.png?fit=300%2C200&ssl=1" alt="Merzaai Logo">
          </div>
        </div>
        
        <!-- Invoice Title -->
        <div class="invoice-title">
          COMMERCIAL INVOICE
        </div>
        
        <!-- Details Section -->
        <div class="details-section">
          <div class="from-to">
            <h3>FROM</h3>
            <div class="address-block">
              <strong>MERZAAI FZCO</strong>
              Dubai Silicon Oasis<br>
              Dubai, United Arab Emirates<br>
              <strong>TRN:</strong> 123456789012345<br>
              <strong>Phone:</strong> +971 4 123 4567<br>
              <strong>Email:</strong> invoices@merzaai.com
            </div>
          </div>
          
          <div class="from-to">
            <h3>BILL TO</h3>
            <div class="address-block">
              <strong>${isCustom ? customInvoiceData.companyName : customer?.company}</strong>
              ${isCustom ? customInvoiceData.contactPerson : customer?.name}<br>
              ${isCustom ? customInvoiceData.address : customer?.address}<br>
              <strong>TRN:</strong> ${isCustom ? (customInvoiceData.trnNumber || 'N/A') : (customer?.trn || 'N/A')}<br>
              <strong>Phone:</strong> ${isCustom ? customInvoiceData.phone : customer?.phone}<br>
              <strong>Email:</strong> ${isCustom ? customInvoiceData.email : customer?.email}
            </div>
          </div>
        </div>
        
        <!-- Invoice Meta - 3 in one row -->
        <div class="details-section">
          <div class="invoice-meta" style="grid-column: 1 / -1;">
            <h3>INVOICE DETAILS</h3>
            <div class="meta-grid">
              <div class="meta-item">
                <span class="meta-label">Invoice Number</span>
                <span class="meta-value">${invoiceNumber}</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Invoice Date</span>
                <span class="meta-value">${formData.date}</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Due Date</span>
                <span class="meta-value">${formData.dueDate}</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Currency</span>
                <span class="meta-value">AED</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Payment Terms</span>
                <span class="meta-value">Net 30 Days</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Reference</span>
                <span class="meta-value">${invoiceNumber}</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Items Section -->
        <div class="items-section">
         <table class="items-table">
  <thead>
    <tr>
      <th style="text-align: left; width: 45%;">Item</th>
      <th style="text-align: right; width: 20%;">Unit Price</th>
      <th style="text-align: center; width: 15%;">Qty</th>
      <th style="text-align: right; width: 20%;">Amount</th>
    </tr>
  </thead>
  <tbody>
    ${formData.items.map(item => `
      <tr>
        <td style="text-align: left; width: 45%; padding: 12px 10px;">${item.description || 'Service'}</td>
        <td style="text-align: right; width: 20%; padding: 12px 10px;">AED ${parseFloat(item.price || 0).toFixed(2)}</td>
        <td style="text-align: center; width: 15%; padding: 12px 10px;">${item.quantity || 1}</td>
        <td style="text-align: right; width: 20%; padding: 12px 10px;">AED ${parseFloat(item.amount || 0).toFixed(2)}</td>
      </tr>
    `).join('')}
  </tbody>
</table>
        </div>
        
        <!-- Totals Section -->
        <div class="totals-section">
          <div class="total-row">
            <span>Gross Amount:</span>
            <span class="amount">AED ${subtotal.toFixed(2)}</span>
          </div>
          <div class="total-row">
            <span>VAT (5%):</span>
            <span class="amount">AED ${vat.toFixed(2)}</span>
          </div>
          <div class="total-row final">
            <span>Total Amount Due:</span>
            <span class="amount">AED ${total.toFixed(2)}</span>
          </div>
        </div>
        
        <!-- Payment & Signature Section -->
        <div class="payment-section">
          <div class="bank-details">
            <h4>Bank Transfer Details</h4>
            <div class="bank-info">
              <strong>Account Name:</strong> MERZAAI FZCO<br>
              <strong>Account Number:</strong> 1234 5678 9012<br>
              <strong>IBAN:</strong> AE07 0331 2345 6789 0123 456<br>
              <strong>Bank Name:</strong> Emirates NBD<br>
              <strong>Swift Code:</strong> EBILAEAD<br>
              <strong>Payment Reference:</strong> ${invoiceNumber}
            </div>
          </div>
          
          <div class="signature-section">
            <h4>Authorized Signature</h4>
            <div class="signature-area">
              <img src="https://www.freepnglogos.com/uploads/signature-png/gary-vaynerchuk-signature-0.png" 
                   alt="Authorized Signature" class="signature-img">
              <div class="signature-line"></div>
              <div style="font-size: 11px; margin-bottom: 15px;">Authorized Signatory</div>
              
              <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ01OD98xvgcOPmQl87qxNgx-pyNdNq40YNTw&s" 
                   alt="Company Stamp" class="stamp-img">
              <div style="font-size: 11px;">Company Stamp</div>
            </div>
          </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
          <p>Thank you for your business with MERZAAI</p>
          <p>Payment due within 30 days. Late payments subject to 2% monthly interest.</p>
          <p>For inquiries: accounts@merzaai.com | +971 4 123 4567 | merzaai.com</p>
        </div>
      </div>
    </body>
    </html>